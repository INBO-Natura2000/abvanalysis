```{r {{id}}-set}
if (interactive()) {
  resultaten$meta %>%
    sample_n(1) %>%
    pull(hash) -> id
} else {
  id <- "{{id}}"
}
```

```{r {{id}}-basis}
if (sum(aantal$hash == id) == 0) {
  dit_aantal <- data.frame()
  deze_wijziging <- data.frame(cycle = logical(0))
  titel <- ""
} else {
  aantal %>%
    filter(hash == id) %>%
    mutate(
      text_median = sprintf(
        sprintf(
          "%%i %1$s (%1$s; %1$s)", 
          sprintf("%%.%if", 1 - floor(log10(min(lcl90))))),
          parameter, median, lcl90, ucl90
      )
    ) -> dit_aantal
  wijziging %>%
    filter(hash == id) -> deze_wijziging
  resultaten$meta %>%
    filter(hash == id) %>%
    slice(1) %>%
    pull(species_group) -> soort_naam
  lineair %>%
    filter(hash == id) -> deze_lineair
  stratum_gewicht %>%
    filter(hash == id) -> dit_stratum
  tolower(soort_naam) %>% 
    str_replace_all(" ", "-") %>% 
    str_remove_all("'") %>%
    sprintf(fmt = "# %2$s {#soort-%1$s}", soort_naam) -> titel
}
```

`r titel`

Op basis van driejaarlijkse gegevens zien we gemiddeld `r deze_lineair$tekst[deze_lineair$frequentie == "driejaarlijks"]` `r deze_lineair$jaarlijks[deze_lineair$frequentie == "driejaarlijks"]` per jaar of `r deze_lineair$looptijd[deze_lineair$frequentie == "driejaarlijks"]` over de volledige looptijd van het meetnet.
Deze trend is `r deze_lineair$interpretatie[deze_lineair$frequentie == "driejaarlijks"]`.

Op basis van jaarlijkse gegevens zien we gemiddeld `r deze_lineair$tekst[deze_lineair$frequentie == "jaarlijks"]` `r deze_lineair$jaarlijks[deze_lineair$frequentie == "jaarlijks"]` per jaar of `r deze_lineair$looptijd[deze_lineair$frequentie == "jaarlijks"]` over de volledige looptijd van het meetnet.
Deze trend is `r deze_lineair$interpretatie[deze_lineair$frequentie == "jaarlijks"]`.


(ref:{{id}}-aantal) Evolutie van het gemodeleerde gemiddeld aantal waargenomen dieren op een meetpunt voor `r soort_naam` tijdens de referentieperiode. Zie ยง\@ref(s:onzekerheid) voor een verklaring van de intervallen.

```{r {{id}}-aantal, fig.cap = "(ref:{{id}}-aantal)", eval = output_format == "html" && nrow(dit_aantal) > 0, warning = FALSE}
dit_aantal %>%
  filter(!cycle) -> aantal_jaar
dit_aantal %>%
  filter(cycle) %>%
  transmute(parameter, low = lcl90, high = ucl90, level = 90) %>%
  bind_rows(
    dit_aantal %>%
      filter(cycle) %>%
      transmute(parameter, low = lcl60, high = ucl60, level = 60),
    dit_aantal %>%
      filter(cycle) %>%
      transmute(parameter, low = lcl30, high = ucl30, level = 30)
  ) %>%
  mutate(
    id = interaction(parameter, level)
  ) -> poly_cyclus
bind_rows(
  transmute(poly_cyclus, id, x = parameter - 1.4, y = low, level),
  transmute(poly_cyclus, id, x = parameter + 1.4, y = low, level),
  transmute(poly_cyclus, id, x = parameter + 1.4, y = high, level),
  transmute(poly_cyclus, id, x = parameter - 1.4, y = high, level)
) %>%
  group_by(id) -> poly_cyclus
dit_aantal %>%
  filter(cycle) %>%
  transmute(parameter, label = sprintf("%i-%i", parameter, parameter + 2)) -> 
  cyclus_labs
updatemenus <- list(
  list(
    active = 0,
    showactive = FALSE, 
    type = "dropdown",
    y = 1.2,
    buttons = list(
      list(
        label = "Driejaarlijks",
        method = "update",
        args = list(
          list(visible = c(FALSE, TRUE)),
          list(
            xaxis = list(
              tickvals = cyclus_labs$parameter,
              ticktext = cyclus_labs$label
            )
          )
        )
      ),
      list(
        label = "Jaarlijks",
        method = "update",
        args = list(
          list(visible = c(TRUE, FALSE)),
          list(
            xaxis = list(tick0 = 2007)
          )
        )
      )
    )
  )
)
plot_ly(
  fillcolor = inbo.steun.blauw, opacity = 0.3, showlegend = FALSE, 
  hoverinfo = "none"
) %>%
  add_ribbons(
    data = aantal_jaar, x = ~parameter, ymin = ~lcl90, ymax = ~ucl90, 
    line = list(width = 0), visible = FALSE
  ) %>%
  add_polygons(
    data = filter(poly_cyclus, level == 90),
    x = ~x, y = ~y, line = list(width = 0)
  ) %>%
  add_ribbons(
    data = aantal_jaar, x = ~parameter, ymin = ~lcl60, ymax = ~ucl60, 
    line = list(width = 0), visible = FALSE
  ) %>%
  add_polygons(
    data = filter(poly_cyclus, level == 60),
    x = ~x, y = ~y, line = list(width = 0)
  ) %>%
  add_ribbons(
    data = aantal_jaar, x = ~parameter, ymin = ~lcl30, ymax = ~ucl30, 
    line = list(width = 0), visible = FALSE
  ) %>%
  add_polygons(
    data = filter(poly_cyclus, level == 30),
    x = ~x, y = ~y, line = list(width = 0)
  ) %>%
  add_lines(
    data = aantal_jaar, x = ~parameter, y = ~median,
    visible = FALSE, line = list(color = inbo.steun.blauw, width = 4), 
    text = ~hover, hoverinfo = "text"
  ) %>%
  add_lines(
    data = dit_aantal %>%
      filter(cycle) %>%
      transmute(parameter, median, hover, start = -1.4, mid = 0, end = 1.4) %>%
      pivot_longer(c("start", "mid", "end")) %>%
      mutate(x = parameter + value) %>%
      group_by(parameter),
    x = ~x, y = ~median, text = ~hover, hoverinfo = "text", 
    line = list(color = inbo.steun.blauw, width = 4)
  ) %>%
  layout(
    updatemenus = updatemenus,
    xaxis = list(
      title = "",
      tickvals = cyclus_labs$parameter,
      ticktext = cyclus_labs$label
    ),
    yaxis = list(
      title = "gemiddeld aantal dieren per meetpunt",
      range = range(pretty(c(0, max(dit_aantal$ucl90))))
    ),
    title = soort_naam,
    hoverlabel = list(
      bgcolor = inbo.lichtblauw,
      bordercolor = inbo.steun.blauw
    )
  ) %>%
  config(
    modeBarButtonsToRemove = list(
      "lasso2d", "select2d", "autoScale2d", "hoverClosestCartesian", 
      "hoverCompareCartesian", "toggleSpikelines"
    ),
    displaylogo = FALSE
  )
```

```{r {{id}}-aantal3, fig.cap = "(ref:{{id}}-aantal)", eval = output_format != "html" && nrow(dit_aantal) > 0, warning = FALSE}
dit_aantal %>%
  filter(cycle) %>%
  mutate(
    parameter = factor(
      parameter,
      levels = sort(unique(parameter)),
      labels = sprintf(
        "%i-%i", 
        sort(unique(parameter)), 
        sort(unique(parameter)) + 2
      )
    )
  ) %>%
  ggplot(aes(x = parameter, y = exp(log_mean), link_sd = log_sd)) +
  stat_fan(link = "log", geom = "rect") +
  geom_point() +
  scale_y_continuous(
    "gemiddeld aantal dieren per meetpunt", 
    limits = c(0, NA)
  ) +
  theme(axis.title.x = element_blank())
```

```{r {{id}}-aantal2, fig.cap = "(ref:{{id}}-aantal)", eval = output_format != "html" && nrow(dit_aantal) > 0, warning = FALSE}
dit_aantal %>%
  filter(!cycle) %>%
  ggplot(aes(x = parameter, y = exp(log_mean), link_sd = log_sd)) +
  stat_fan(link = "log") +
  geom_line() +
  scale_x_continuous(breaks = pretty) +
  scale_y_continuous(
    "gemiddeld aantal dieren per meetpunt", 
    limits = c(0, NA)
  ) +
  theme(axis.title.x = element_blank())
```

(ref:{{id}}-index) Wijzigingen t.o.v. de start van het meetnet voor `r soort_naam`. Zie ยง\@ref(s:onzekerheid) voor een verklaring van de intervallen en ยง\@ref(s:trendklasse) voor uitleg over de symbolen en referentielijnen.

```{r {{id}}-wijziging-jaar, fig.cap = "(ref:{{id}}-index)", eval = output_format == "html" && nrow(dit_aantal) > 0, warning = FALSE}
deze_wijziging %>%
  filter(referentie == min(referentie)) %>%
  select(naar, cycle, starts_with("lcl"), starts_with("ucl")) %>%
  pivot_longer(c(starts_with("lcl"), starts_with("ucl"))) %>%
  extract(name, into = c("threshold", "level"), "(.cl)(.*)") %>%
  inner_join(
    expand.grid(
      cycle = c(FALSE, TRUE),
      delta = c(-1, 1)
    ), 
    by = "cycle"
  ) %>%
  mutate(
    value = log(value),
    delta = (cycle + 0.4) * delta,
    x = naar + delta
  ) %>%
  group_by(cycle, level, naar) %>%
  arrange(threshold, ifelse(threshold == "lcl", x, -x)) -> change
breaks <- index_breaks(change$value)
deze_wijziging %>%
  filter(cycle) %>%
  transmute(naar, label = sprintf("%i-%i", naar, naar + 2)) -> cyclus_labs
updatemenus <- list(
  list(
    active = 0,
    showactive = FALSE, 
    type = "dropdown",
    y = 1.2,
    buttons = list(
      list(
        label = "Driejaarlijks",
        method = "update",
        args = list(
          list(visible = c(FALSE, TRUE)),
          list(
            title = paste("Wijziging t.o.v. 2007-2009 voor", soort_naam),
            xaxis = list(
              tickvals = cyclus_labs$naar,
              ticktext = cyclus_labs$label
            )
          )
        )
      ),
      list(
        label = "Jaarlijks",
        method = "update",
        args = list(
          list(visible = c(TRUE, FALSE)),
          list(
            title = paste("Wijziging t.o.v. 2007 voor", soort_naam),
            xaxis = list(tick0 = 2008, dtick = 1)
          )
        )
      )
    )
  )
)
plot_ly(
  fillcolor = inbo.steun.blauw, opacity = 0.3, showlegend = FALSE, 
  hoverinfo = "none"
) %>%
  add_polygons(
    data = filter(change, !cycle, level == "90"), 
    x = ~x, y = ~value, 
    line = list(width = 0), visible = FALSE
  ) %>%
  add_polygons(
    data = filter(change, cycle, level == "90"), 
    x = ~x, y = ~value, 
    line = list(width = 0)
  ) %>%
  add_polygons(
    data = filter(change, !cycle, level == "60"), 
    x = ~x, y = ~value, 
    line = list(width = 0), visible = FALSE
  ) %>%
  add_polygons(
    data = filter(change, cycle, level == "60"), 
    x = ~x, y = ~value, 
    line = list(width = 0)
  ) %>%
  add_polygons(
    data = filter(change, !cycle, level == "30"), 
    x = ~x, y = ~value, 
    line = list(width = 0), visible = FALSE
  ) %>%
  add_polygons(
    data = filter(change, cycle, level == "30"), 
    x = ~x, y = ~value, 
    line = list(width = 0)
  ) %>%
  add_text(
    data = filter(deze_wijziging, !cycle, referentie == 2007),
    x = ~naar, y = ~log_mean, text = ~klasse,
    textfont = list(color = inbo.steun.blauw, size = 20), 
    opacity = 1, visible = FALSE
  ) %>%
  add_text(
    data = filter(deze_wijziging, cycle, referentie == 2007),
    x = ~naar, y = ~log_mean, text = ~klasse,
    textfont = list(color = inbo.steun.blauw, size = 20), 
    opacity = 1
  ) %>%
  add_markers(
    data = filter(deze_wijziging, !cycle, referentie == 2007),
    x = ~naar, y = ~log_mean, text = ~wijziging,
    hoverinfo = "text", opacity = 0, visible = FALSE
  ) %>%
  add_markers(
    data = filter(deze_wijziging, cycle, referentie == 2007),
    x = ~naar, y = ~log_mean, text = ~wijziging,
    hoverinfo = "text", opacity = 0
  ) %>%
  add_lines(
    data = expand.grid(
      x = range(change$naar[!change$cycle]) + c(-0.5, 0.5), 
      y = log(0.75) * c(-1, 1)
    ) %>%
      group_by(y),
    x = ~x, y = ~y,
    line = list(color = inbo.steun.blauw, dash = "dash"), opacity = 1, 
    visible = FALSE
  ) %>%
  add_lines(
    data = expand.grid(
      x = range(change$naar[change$cycle]) + c(-1.5, 1.5), 
      y = log(0.75) * c(-1, 1)
    ) %>%
      group_by(y),
    x = ~x, y = ~y,
    line = list(color = inbo.steun.blauw, dash = "dash"), opacity = 1
  ) %>%
  add_lines(
    data = expand.grid(
      x = range(change$naar[!change$cycle]) + c(-0.5, 0.5), 
      y = 0
    ) %>%
      group_by(y),
    x = ~x, y = ~y,
    line = list(color = inbo.steun.blauw), opacity = 1, visible = FALSE
  ) %>%
  add_lines(
    data = expand.grid(
      x = range(change$naar[change$cycle]) + c(-1.5, 1.5), 
      y = 0
    ) %>%
      group_by(y),
    x = ~x, y = ~y,
    line = list(color = inbo.steun.blauw), opacity = 1
  ) %>%
  layout(
    updatemenus = updatemenus,
    xaxis = list(
      title = "",
      tickvals = cyclus_labs$naar,
      ticktext = cyclus_labs$label
    ),
    yaxis = list(
      title = "Procentuele wijziging",
      tickvals = breaks,
      ticktext = index_labels(breaks),
      zeroline = FALSE
    ),
    title = paste("Wijziging t.o.v. 2007-2009 voor", soort_naam),
    hoverlabel = list(
      bgcolor = inbo.lichtblauw,
      bordercolor = inbo.steun.blauw
    )
  ) %>%
  config(
    modeBarButtonsToRemove = list(
      "lasso2d", "select2d", "autoScale2d", "hoverClosestCartesian", 
      "hoverCompareCartesian", "toggleSpikelines"
    ),
    displaylogo = FALSE
  )
```

(ref:{{id}}-index3) Wijzigingen t.o.v. het eerste driejarige cyclus voor `r soort_naam`. Zie ยง\@ref(s:onzekerheid) voor een verklaring van de intervallen en ยง\@ref(s:trendklasse) voor uitleg over de symbolen en referentielijnen.

```{r {{id}}-wijziging-cyclus, fig.cap = "(ref:{{id}}-index3)", eval = output_format != "html" && nrow(deze_wijziging) > 0}
deze_wijziging %>%
  filter(referentie == min(referentie), cycle) %>%
  mutate(
    naar = sprintf("%i-%i", naar, naar + 2) %>%
      factor()
  ) %>%
  ggplot(aes(x = naar, y = log_mean, link_sd = log_sd)) +
  geom_hline(yintercept = 0, linetype = 2) +
  geom_hline(yintercept = log(c(3/4, 4/3)), linetype = 3) +
  stat_fan(geom = "rect") +
  stat_effect(
    aes(ymin = log(lcl90), ymax = log(ucl90)), 
    threshold = log(0.75)
  ) +
  scale_effect("klasse") +
  scale_y_continuous(
    "procentuele wijziging t.o.v. 2007-2009", 
    breaks = index_breaks, labels = index_labels,
    sec.axis = sec_axis(
      trans = exp, name = "relatieve wijziging t.o.v. 2007-2009",
      breaks = function(x){exp(index_breaks(log(x)))}, 
      labels = function(x){signif(x, 3)}
    )
  ) +
  theme(axis.title.x = element_blank())
```

(ref:{{id}}-index2) Wijzigingen t.o.v. het eerste jaar voor `r soort_naam`. Zie ยง\@ref(s:onzekerheid) voor een verklaring van de intervallen en ยง\@ref(s:trendklasse) voor uitleg over de symbolen en referentielijnen.

```{r {{id}}-wijziging-jaar2, fig.cap = "(ref:{{id}}-index2)", eval = output_format != "html" && nrow(deze_wijziging) > 0}
deze_wijziging %>%
  filter(referentie == min(referentie), !cycle) %>%
  ggplot(aes(x = naar, y = log_mean, link_sd = log_sd)) +
  geom_hline(yintercept = 0, linetype = 2) +
  geom_hline(yintercept = log(c(3/4, 4/3)), linetype = 3) +
  stat_fan(geom = "rect") +
  stat_effect(
    aes(ymin = log(lcl90), ymax = log(ucl90)), 
    threshold = log(0.75)
  ) +
  scale_effect("klasse") +
  scale_x_continuous(breaks = pretty) +
  scale_y_continuous(
    "procentuele wijziging t.o.v. 2007", 
    breaks = index_breaks, labels = index_labels,
    sec.axis = sec_axis(
      trans = exp, name = "relatieve wijziging t.o.v. 2007",
      breaks = function(x){exp(index_breaks(log(x)))}, 
      labels = function(x){signif(x, 3)}
    )
  ) +
  theme(axis.title.x = element_blank())
```

(ref:{{id}}-raster) Paarsgewijze vergelijking tussen jaren of driejarige cycli voor `r soort_naam`. Uitleg van de symbolen in tabel \@ref(tab:regels).

(ref:{{id}}-raster2) Paarsgewijze vergelijking tussen jaren voor `r soort_naam`. Uitleg van de symbolen in tabel \@ref(tab:regels).

(ref:{{id}}-raster3) Paarsgewijze vergelijking tussen driejarige cycli voor `r soort_naam`. Uitleg van de symbolen in tabel \@ref(tab:regels).

```{r {{id}}-wijziging-jaar-alles, fig.cap = "(ref:{{id}}-raster)", eval = output_format == "html" && nrow(deze_wijziging) > 0}
deze_wijziging %>%
  filter(!cycle) %>%
  mutate(
    kleur = rescale_mid(log_mean, c(0, 1), range(log_mean)) %>%
      kleurgradient()
  ) -> change_jaar
deze_wijziging %>%
  filter(cycle) %>%
  mutate(
    kleur = rescale_mid(log_mean, c(0, 1), range(log_mean)) %>%
      kleurgradient()
  ) -> change_cyclus
change_cyclus %>%
  filter(cycle) %>%
  transmute(naar, label = sprintf("%i-%i", naar, naar + 2)) -> cyclus_labs
updatemenus <- list(
  list(
    active = 0,
    showactive = FALSE, 
    type = "dropdown",
    y = 1.2,
    buttons = list(
      list(
        label = "Driejaarlijks",
        method = "update",
        args = list(
          list(visible = c(FALSE, TRUE)),
          list(
            title = paste(
              "Paarsgewijze wijzigingen tussen driejarige cycli\nvoor", 
              soort_naam
            ),
            xaxis = list(
              tickvals = cyclus_labs$naar,
              ticktext = cyclus_labs$label
            ),
            yaxis = list(
              title = "Referentiecyclus",
              tickvals = cyclus_labs$naar,
              ticktext = cyclus_labs$label
            )
          )
        )
      ),
      list(
        label = "Jaarlijks",
        method = "update",
        args = list(
          list(visible = c(TRUE, FALSE)),
          list(
            title = paste(
              "Paarsgewijze wijzigingen tussen jaren\nvoor", 
              soort_naam
            ),
            xaxis = list(tick0 = 2008, dtick = 1),
            yaxis = list(tick0 = 2008, dtick = 1, title = "Referentiejaar")
          )
        )
      )
    )
  )
)
plot_ly(
  data = change_jaar,
  x = ~naar, y = ~referentie, text = ~klasse, showlegend = FALSE
) %>%
  add_text(
    textfont = list(color = ~change_jaar$kleur, size = 20), 
    hoverinfo = "none", visible = FALSE
  ) %>%
  add_text(
    data = change_cyclus,
    textfont = list(color = ~change_cyclus$kleur, size = 20), 
    hoverinfo = "none"
  ) %>%
  add_markers(
    data = change_jaar,
    text = ~wijziging, hoverinfo = "text", opacity = 0, visible = FALSE
  ) %>%
  add_markers(
    data = change_cyclus, text = ~wijziging, 
    hoverinfo = "text", opacity = 0
  ) %>%
  layout(
    updatemenus = updatemenus,
    xaxis = list(
      title = "",
      tickvals = cyclus_labs$naar,
      ticktext = cyclus_labs$label
    ),
    yaxis = list(
      title = "Referentiecyclus",
      tickvals = cyclus_labs$naar,
      ticktext = cyclus_labs$label
    ),
    title = paste(
      "Paarsgewijze wijzigingen tussen driejarige cycli\nvoor", 
      soort_naam
    ),
    hoverlabel = list(
      bgcolor = inbo.lichtblauw,
      bordercolor = inbo.steun.blauw
    )
  ) %>%
  config(
    modeBarButtonsToRemove = list(
      "lasso2d", "select2d", "autoScale2d", "hoverClosestCartesian", 
      "hoverCompareCartesian", "toggleSpikelines"
    ),
    displaylogo = FALSE
  )
```

```{r {{id}}-wijziging-jaar-alles3, fig.cap = "(ref:{{id}}-raster3)", eval = output_format != "html" && nrow(deze_wijziging) > 0}
deze_wijziging %>%
  filter(cycle) %>%
  ggplot(aes(x = naar, y = referentie, colour = log_mean)) +
  stat_effect(
    aes(ymin = lcl90, ymax = ucl90), 
    threshold = c(0.75, 1/0.75), 
    reference = 1
  ) +
  scale_x_continuous(
    breaks = function(x) {seq(2007, x[2], by = 3)},
    labels = function(x) {sprintf("%02i-%02i", x, x + 2)}
  ) +
  scale_y_continuous(
    breaks = function(x) {seq(2007, x[2], by = 3)},
    labels = function(x) {sprintf("%02i-%02i", x, x + 2)}
  ) +
  scale_effect("klasse", guide = guide_legend(ncol = 3)) +
  scale_colour_gradient2(
    "wijziging", breaks = index_breaks2, labels = index_labels,
    guide = guide_colorbar(barheight = unit(5, "lines"))
  ) +
  coord_fixed() +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_text(angle = 90, vjust = 0.5)
  )
```

```{r {{id}}-wijziging-jaar-alles2, fig.cap = "(ref:{{id}}-raster2)", eval = output_format != "html" && nrow(deze_wijziging) > 0}
deze_wijziging %>%
  filter(!cycle) %>%
  ggplot(aes(x = naar, y = referentie, colour = log_mean)) +
  stat_effect(
    aes(ymin = lcl90, ymax = ucl90), 
    threshold = c(0.75, 1/0.75), 
    reference = 1
  ) +
  scale_x_continuous(breaks = pretty) +
  scale_y_continuous(breaks = pretty) +
  scale_effect("klasse", guide = guide_legend(ncol = 3)) +
  scale_colour_gradient2(
    "wijziging", breaks = index_breaks2, labels = index_labels
  ) +
  coord_fixed() +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_text(angle = 90, vjust = 0.5)
  )
```

(ref:{{id}}-sg) Stratumgewicht, raming aan het aantal hokken waarin de soort aanwezig is, aantal relevant hokken voor de analyse, aantal onderzochte hokken in het stratum, totaal aantal hokken van het stratum in Vlaanderen en aantal bezoeken aan een meetpunt voor `r soort_naam` (zie ยง\@ref(s:stratumgewicht)).

```{r {{id}}-sd}
dit_stratum %>%
  select(-hash) %>%
  mutate(
    gewicht = sprintf("%.1f%%", 100 * gewicht),
    aanwezig = round(aanwezig, 1)
  ) %>%
  kable(caption = "(ref:{{id}}-sg)", align = "lrrrrrr")
```

(ref:{{id}}-hash) Data-hashes van de analyses in het kader van traceerbaarheid (zie ยง\@ref(s:traceerbaarheid)).

```{r {{id}}-hash, results = "asis"}
resultaten$meta %>%
  filter(hash == id) %>%
  arrange(cycle, nonlinear) %>%
  transmute(
    frequentie = factor(
      cycle, 
      levels = c(TRUE, FALSE), 
      labels = c("driejaarlijks", "jaarlijks")
    ),
    model = ifelse(nonlinear, "niet-lineair", "lineair"),
    analyse = str_replace(analysis, "(.{20})", "\\1 "), 
    status = str_replace(status, "(.{20})", "\\1 ")
  ) %>%
  pandoc.table(caption = "(\\#tab:{{id}}-hash) (ref:{{id}}-hash)")
```
